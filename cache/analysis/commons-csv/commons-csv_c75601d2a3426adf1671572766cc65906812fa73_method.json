{
  "cache_key": "commons-csv_c75601d2a3426adf1671572766cc65906812fa73_method",
  "cached_at": "2026-01-24T04:57:09.378665",
  "project": "commons-csv",
  "commit_hash": "c75601d2a3426adf1671572766cc65906812fa73",
  "phase": "method",
  "data": {
    "commit_hash": "c75601d2a3426adf1671572766cc65906812fa73",
    "parent_hash": "76981db68af50e0475a2d5d0fcc6bdf87efb18f1",
    "basic_info": {
      "project": "commons-csv",
      "commit_hash": "c75601d2a3426adf1671572766cc65906812fa73",
      "short_hash": "c75601d2",
      "parent_hash": "76981db68af50e0475a2d5d0fcc6bdf87efb18f1",
      "parent_short_hash": "76981db6",
      "author": "Gary Gregory",
      "date": "2025-01-02 20:14:43",
      "message": "Use final",
      "message_subject": "Use final"
    },
    "file_changes": {
      "source_files": [
        {
          "path": "src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java",
          "change_type": "modified",
          "old_path": null,
          "is_java": true
        }
      ],
      "test_files": [
        {
          "path": "src/test/java/org/apache/commons/csv/JiraCsv196Test.java",
          "change_type": "modified",
          "old_path": null,
          "is_java": true
        }
      ],
      "other_files": [],
      "summary": {
        "total_files": 2,
        "source_count": 1,
        "test_count": 1,
        "other_count": 0
      }
    },
    "method_changes": {
      "source_methods": [
        {
          "class": "ExtendedBufferedReader",
          "method": "getEncodedCharLength",
          "parameters": [
            "int"
          ],
          "start_line": 136,
          "end_line": 152,
          "file": "src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java",
          "package": "org.apache.commons.csv"
        }
      ],
      "test_methods": [
        {
          "class": "JiraCsv196Test",
          "method": "getTestInput",
          "parameters": [
            "String"
          ],
          "start_line": 32,
          "end_line": 34,
          "file": "src/test/java/org/apache/commons/csv/JiraCsv196Test.java",
          "package": "org.apache.commons.csv",
          "is_test_method": false
        }
      ],
      "summary": {
        "source_methods_count": 1,
        "test_methods_count": 1
      }
    },
    "diff_info": {
      "full_diff": "diff --git a/src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java b/src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java\nindex 31890db8..957c78bb 100644\n--- a/src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java\n+++ b/src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java\n@@ -78,7 +78,7 @@ final class ExtendedBufferedReader extends UnsynchronizedBufferedReader {\n      * @param charset the character set for encoding, or {@code null} if not applicable.\n      * @param enableByteTracking {@code true} to enable byte tracking; {@code false} to disable it.\n      */\n-    ExtendedBufferedReader(final Reader reader, Charset charset, boolean enableByteTracking) {\n+    ExtendedBufferedReader(final Reader reader, final Charset charset, final boolean enableByteTracking) {\n         super(reader);\n         if (charset != null && enableByteTracking) {\n             encoder = charset.newEncoder();\n@@ -133,22 +133,21 @@ final class ExtendedBufferedReader extends UnsynchronizedBufferedReader {\n      * @return the byte length of the character.\n      * @throws CharacterCodingException if the character cannot be encoded.\n      */\n-    private int getEncodedCharLength(int current) throws CharacterCodingException {\n+    private int getEncodedCharLength(final int current) throws CharacterCodingException {\n         final char cChar = (char) current;\n         final char lChar = (char) lastChar;\n         if (!Character.isSurrogate(cChar)) {\n             return encoder.encode(\n                 CharBuffer.wrap(new char[] {cChar})).limit();\n+        }\n+        if (Character.isHighSurrogate(cChar)) {\n+            // Move on to the next char (low surrogate)\n+            return 0;\n+        } else if (Character.isSurrogatePair(lChar, cChar)) {\n+            return encoder.encode(\n+                CharBuffer.wrap(new char[] {lChar, cChar})).limit();\n         } else {\n-            if (Character.isHighSurrogate(cChar)) {\n-                // Move on to the next char (low surrogate)\n-                return 0;\n-            } else if (Character.isSurrogatePair(lChar, cChar)) {\n-                return encoder.encode(\n-                    CharBuffer.wrap(new char[] {lChar, cChar})).limit();\n-            } else {\n-                throw new CharacterCodingException();\n-            }\n+            throw new CharacterCodingException();\n         }\n     }\n \ndiff --git a/src/test/java/org/apache/commons/csv/JiraCsv196Test.java b/src/test/java/org/apache/commons/csv/JiraCsv196Test.java\nindex 3a4b09ca..54d28256 100644\n--- a/src/test/java/org/apache/commons/csv/JiraCsv196Test.java\n+++ b/src/test/java/org/apache/commons/csv/JiraCsv196Test.java\n@@ -29,7 +29,7 @@ import org.junit.jupiter.api.Test;\n \n public class JiraCsv196Test {\n \n-    private Reader getTestInput(String path) {\n+    private Reader getTestInput(final String path) {\n         return new InputStreamReader(ClassLoader.getSystemClassLoader().getResourceAsStream(path));\n     }\n ",
      "source_only_diff": "diff --git a/src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java b/src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java\nindex 31890db8..957c78bb 100644\n--- a/src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java\n+++ b/src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java\n@@ -78,7 +78,7 @@ final class ExtendedBufferedReader extends UnsynchronizedBufferedReader {\n      * @param charset the character set for encoding, or {@code null} if not applicable.\n      * @param enableByteTracking {@code true} to enable byte tracking; {@code false} to disable it.\n      */\n-    ExtendedBufferedReader(final Reader reader, Charset charset, boolean enableByteTracking) {\n+    ExtendedBufferedReader(final Reader reader, final Charset charset, final boolean enableByteTracking) {\n         super(reader);\n         if (charset != null && enableByteTracking) {\n             encoder = charset.newEncoder();\n@@ -133,22 +133,21 @@ final class ExtendedBufferedReader extends UnsynchronizedBufferedReader {\n      * @return the byte length of the character.\n      * @throws CharacterCodingException if the character cannot be encoded.\n      */\n-    private int getEncodedCharLength(int current) throws CharacterCodingException {\n+    private int getEncodedCharLength(final int current) throws CharacterCodingException {\n         final char cChar = (char) current;\n         final char lChar = (char) lastChar;\n         if (!Character.isSurrogate(cChar)) {\n             return encoder.encode(\n                 CharBuffer.wrap(new char[] {cChar})).limit();\n+        }\n+        if (Character.isHighSurrogate(cChar)) {\n+            // Move on to the next char (low surrogate)\n+            return 0;\n+        } else if (Character.isSurrogatePair(lChar, cChar)) {\n+            return encoder.encode(\n+                CharBuffer.wrap(new char[] {lChar, cChar})).limit();\n         } else {\n-            if (Character.isHighSurrogate(cChar)) {\n-                // Move on to the next char (low surrogate)\n-                return 0;\n-            } else if (Character.isSurrogatePair(lChar, cChar)) {\n-                return encoder.encode(\n-                    CharBuffer.wrap(new char[] {lChar, cChar})).limit();\n-            } else {\n-                throw new CharacterCodingException();\n-            }\n+            throw new CharacterCodingException();\n         }\n     }\n \n",
      "test_only_diff": "diff --git a/src/test/java/org/apache/commons/csv/JiraCsv196Test.java b/src/test/java/org/apache/commons/csv/JiraCsv196Test.java\nindex 3a4b09ca..54d28256 100644\n--- a/src/test/java/org/apache/commons/csv/JiraCsv196Test.java\n+++ b/src/test/java/org/apache/commons/csv/JiraCsv196Test.java\n@@ -29,7 +29,7 @@ import org.junit.jupiter.api.Test;\n \n public class JiraCsv196Test {\n \n-    private Reader getTestInput(String path) {\n+    private Reader getTestInput(final String path) {\n         return new InputStreamReader(ClassLoader.getSystemClassLoader().getResourceAsStream(path));\n     }\n ",
      "stats": {
        "source_files": 1,
        "test_files": 1,
        "filtered": true
      },
      "change_stats": {
        "full": {
          "files": [
            {
              "path": "src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java",
              "lines_added": 10,
              "lines_removed": 11,
              "is_new": false,
              "is_deleted": false
            },
            {
              "path": "src/test/java/org/apache/commons/csv/JiraCsv196Test.java",
              "lines_added": 1,
              "lines_removed": 1,
              "is_new": false,
              "is_deleted": false
            }
          ],
          "total_lines_added": 11,
          "total_lines_removed": 12
        },
        "source": {
          "files": [
            {
              "path": "src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java",
              "lines_added": 10,
              "lines_removed": 11,
              "is_new": false,
              "is_deleted": false
            }
          ],
          "total_lines_added": 10,
          "total_lines_removed": 11
        },
        "test": {
          "files": [
            {
              "path": "src/test/java/org/apache/commons/csv/JiraCsv196Test.java",
              "lines_added": 1,
              "lines_removed": 1,
              "is_new": false,
              "is_deleted": false
            }
          ],
          "total_lines_added": 1,
          "total_lines_removed": 1
        }
      }
    },
    "method_change_stats": {
      "source": [
        {
          "package": "org.apache.commons.csv",
          "class": "ExtendedBufferedReader",
          "method": "getEncodedCharLength",
          "parameters": [
            "int"
          ],
          "file": "src/main/java/org/apache/commons/csv/ExtendedBufferedReader.java",
          "added_lines": 9,
          "removed_lines": 10,
          "total_changed_lines": 19
        }
      ],
      "test": [
        {
          "package": "org.apache.commons.csv",
          "class": "JiraCsv196Test",
          "method": "getTestInput",
          "parameters": [
            "String"
          ],
          "file": "src/test/java/org/apache/commons/csv/JiraCsv196Test.java",
          "added_lines": 1,
          "removed_lines": 1,
          "total_changed_lines": 2
        }
      ]
    },
    "has_method_changes": true
  }
}