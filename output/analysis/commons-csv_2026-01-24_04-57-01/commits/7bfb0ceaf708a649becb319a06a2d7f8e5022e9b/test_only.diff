diff --git a/src/test/java/org/apache/commons/csv/CSVParserTest.java b/src/test/java/org/apache/commons/csv/CSVParserTest.java
index 59a1dd6e..50bf052b 100644
--- a/src/test/java/org/apache/commons/csv/CSVParserTest.java
+++ b/src/test/java/org/apache/commons/csv/CSVParserTest.java
@@ -62,6 +62,7 @@ import org.junit.jupiter.api.Disabled;
 import org.junit.jupiter.api.Test;
 import org.junit.jupiter.params.ParameterizedTest;
 import org.junit.jupiter.params.provider.EnumSource;
+import org.junit.jupiter.params.provider.ValueSource;
 
 /**
  * CSVParserTest
@@ -887,6 +888,20 @@ public class CSVParserTest {
 
     }
 
+    @ParameterizedTest
+    @ValueSource(longs = { -1, 0, 1, 2, 3, 4, Long.MAX_VALUE })
+    public void testGetRecordsMaxRows(final long maxRows) throws IOException {
+        try (CSVParser parser = CSVParser.parse(CSV_INPUT, CSVFormat.DEFAULT.builder().setIgnoreSurroundingSpaces(true).setMaxRows(maxRows).get())) {
+            final List<CSVRecord> records = parser.getRecords();
+            final long expectedLength = maxRows <= 0 || maxRows > RESULT.length ? RESULT.length : maxRows;
+            assertEquals(expectedLength, records.size());
+            assertFalse(records.isEmpty());
+            for (int i = 0; i < expectedLength; i++) {
+                assertArrayEquals(RESULT[i], records.get(i).values());
+            }
+        }
+    }
+
     @Test
     public void testGetRecordThreeBytesRead() throws Exception {
         final String code = "id,date,val5,val4\n" +
@@ -1656,6 +1671,23 @@ public class CSVParserTest {
         }
     }
 
+    @ParameterizedTest
+    @ValueSource(longs = { -1, 0, 1, 2, 3, 4, Long.MAX_VALUE })
+    public void testStreamMaxRows(final long maxRows) throws Exception {
+        final Reader in = new StringReader("a,b,c\n1,2,3\nx,y,z");
+        try (CSVParser parser = CSVFormat.DEFAULT.builder().setMaxRows(maxRows).get().parse(in)) {
+            final List<CSVRecord> list = parser.stream().collect(Collectors.toList());
+            assertFalse(list.isEmpty());
+            assertArrayEquals(new String[] { "a", "b", "c" }, list.get(0).values());
+            if (maxRows <= 0 || maxRows > 1) {
+                assertArrayEquals(new String[] { "1", "2", "3" }, list.get(1).values());
+            }
+            if (maxRows <= 0 || maxRows > 2) {
+                assertArrayEquals(new String[] { "x", "y", "z" }, list.get(2).values());
+            }
+        }
+    }
+
     @Test
     public void testThrowExceptionWithLineAndPosition() throws IOException {
         final String csvContent = "col1,col2,col3,col4,col5,col6,col7,col8,col9,col10\nrec1,rec2,rec3,rec4,rec5,rec6,rec7,rec8,\"\"rec9\"\",rec10";

diff --git a/src/test/java/org/apache/commons/csv/CSVPrinterTest.java b/src/test/java/org/apache/commons/csv/CSVPrinterTest.java
index 36542b99..a1a59cf4 100644
--- a/src/test/java/org/apache/commons/csv/CSVPrinterTest.java
+++ b/src/test/java/org/apache/commons/csv/CSVPrinterTest.java
@@ -710,7 +710,7 @@ public class CSVPrinterTest {
     }
 
     @ParameterizedTest
-    @ValueSource(longs = { -1, 0, 1, 2, Integer.MAX_VALUE })
+    @ValueSource(longs = { -1, 0, 1, 2, Long.MAX_VALUE })
     public void testExcelPrintAllStreamOfArrays(final long maxRows) throws IOException {
         final StringWriter sw = new StringWriter();
         final CSVFormat format = CSVFormat.EXCEL.builder().setMaxRows(maxRows).get();
@@ -840,7 +840,7 @@ public class CSVPrinterTest {
     }
 
     @ParameterizedTest
-    @ValueSource(longs = { -1, 0, 1, 2, 3, 4, Integer.MAX_VALUE })
+    @ValueSource(longs = { -1, 0, 1, 2, 3, 4, Long.MAX_VALUE })
     public void testJdbcPrinterWithResultSet(final long maxRows) throws IOException, ClassNotFoundException, SQLException {
         final StringWriter sw = new StringWriter();
         final CSVFormat format = CSVFormat.DEFAULT.builder().setMaxRows(maxRows).get();
@@ -864,11 +864,11 @@ public class CSVPrinterTest {
             assertEquals(allRows, resultString);
             expectedRowsWithHeader = TABLE_AND_HEADER_RECORD_COUNT;
         }
-        assertRowCount(format, resultString, expectedRowsWithHeader);
+        assertRowCount(CSVFormat.DEFAULT, resultString, expectedRowsWithHeader);
     }
 
     @ParameterizedTest
-    @ValueSource(longs = { -1, 0, 3, 4, Integer.MAX_VALUE })
+    @ValueSource(longs = { -1, 0, 3, 4, Long.MAX_VALUE })
     public void testJdbcPrinterWithResultSetHeader(final long maxRows) throws IOException, ClassNotFoundException, SQLException {
         final StringWriter sw = new StringWriter();
         try (Connection connection = getH2Connection()) {
@@ -887,13 +887,13 @@ public class CSVPrinterTest {
                     assertEquals(TABLE_RECORD_COUNT * 2, printer.getRecordCount());
                     assertNotEquals("ID,NAME" + RECORD_SEPARATOR + "1,r1" + RECORD_SEPARATOR + "2,r2" + RECORD_SEPARATOR, sw.toString());
                 }
-                assertRowCount(format, sw.toString(), TABLE_AND_HEADER_RECORD_COUNT + TABLE_RECORD_COUNT);
+                assertRowCount(CSVFormat.DEFAULT, sw.toString(), TABLE_AND_HEADER_RECORD_COUNT + TABLE_RECORD_COUNT);
             }
         }
     }
 
     @ParameterizedTest
-    @ValueSource(longs = { -1, 0, 3, 4, Integer.MAX_VALUE })
+    @ValueSource(longs = { -1, 0, 3, 4, Long.MAX_VALUE })
     public void testJdbcPrinterWithResultSetMetaData(final long maxRows) throws IOException, ClassNotFoundException, SQLException {
         final StringWriter sw = new StringWriter();
         try (Connection connection = getH2Connection()) {
@@ -1509,7 +1509,7 @@ public class CSVPrinterTest {
     }
 
     @ParameterizedTest
-    @ValueSource(longs = { -1, 0, 3, 4, Integer.MAX_VALUE })
+    @ValueSource(longs = { -1, 0, 3, 4, Long.MAX_VALUE })
     public void testPrintCSVRecords(final long maxRows) throws IOException {
         // @formatter:off
         final String code = "a1,b1\n" + // 1)